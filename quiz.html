<!doctype html><html><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Quiz</title>
<link rel="stylesheet" href="styles.css"/>
<script defer src="common.js"></script>
</head><body>
<header class="nav"><div class="wrap">
  <div class="brand">ðŸ’¡ Brainstorm Universe</div>
  <nav class="links">
    <a href="index.html">Home</a>
    <a href="privacy.html">Privacy</a>
  </nav>
</div></header>
<main class="container">
  <section class="section">
    <h2 id="qh">Quiz</h2>
    <div id="qwrap"></div>
    <div style="margin-top:12px"><button class="btn" id="submitBtn">Submit</button></div>
    <p id="msg" class="small"></p>
  </section>
</main>
<script>
const p = new URLSearchParams(location.search); const i = parseInt(p.get('i')||'0',10);
let answers=[];
fetch('blogs/blog-'+i+'.json').then(r=>r.json()).then(data=>{
  document.getElementById('qh').textContent = 'Quiz: '+data.title;
  const host = document.getElementById('qwrap');
  data.quiz.forEach((q,idx)=>{
    const div = document.createElement('div'); div.className='card'; div.style.marginTop='10px';
    div.innerHTML = `<p>${idx+1}. ${q.q}</p>` + q.options.map((op,oi)=>(
      `<label class="badge"><input type="radio" name="q${idx}" value="${oi}"> ${op}</label>`
    )).join(' ') + `<div class="full-ad ad">Ad</div>`;
    host.appendChild(div);
  });
  answers = data.answers; // correct indices
});

document.getElementById('submitBtn').onclick = async ()=>{
  const name = getName(); if(!name){ alert('Please set your name on Home.'); return }
  const chosen = [];
  for(let k=0;k<answers.length;k++){
    const sel = document.querySelector(`input[name="q${k}"]:checked`);
    chosen.push(sel ? parseInt(sel.value,10) : -1);
  }
  const pass = chosen.length===answers.length && chosen.every((v,idx)=>v===answers[idx]);
  if(pass){
    try{ await jfetch('/api/complete-task',{name,task:'quiz'}) }catch(e){}
    location.href='jumble.html';
  }else{
    document.getElementById('msg').textContent='Oops, not quite right. Try again tomorrow.';
  }
}
</script>
</body></html>
